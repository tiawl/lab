{
  "run": [
    {
      "harden": "ssh"
    },
    {
      "harden": "ssh-keygen"
    },
    {
      "var": "loc",
      "type": "map"
    },
    {
      "var": "project",
      "type": "map"
    },
    {
      "set": "loc",
      "key": "image",
      "value": "local${sep[image]}"
    },
    {
      "set": "project",
      "key": "container",
      "value": "${runner_name}${sep[container]}"
    },
    {
      "set": "project",
      "key": "image",
      "value": "${runner_name}${sep[image]}"
    },
    {
      "set": "version",
      "key": "alpine",
      "value": "3.21"
    },
    {
      "readonly": "loc"
    },
    {
      "readonly": "project"
    },
    {
      "if": {
        "not": {
          "image": {
            "tag": {
              "defined": {
                "image": "${loc[image]}alpine",
                "tag": "${version[alpine]}"
              }
            }
          }
        }
      },
      "then": [
        {
          "image": {
            "pull": {
              "registry": "docker.io",
              "library": "library",
              "image": "alpine",
              "tag": "${version[alpine]}"
            }
          }
        },
        {
          "image": {
            "prune": {
              "matching": "${loc[image]}alpine${sep[tag]}*"
            }
          }
        },
        {
          "image": {
            "tag": {
              "create": {
                "from": {
                  "image": "alpine",
                  "tag": "${version[alpine]}"
                },
                "to": {
                  "image": "${loc[image]}alpine",
                  "tag": "${version[alpine]}"
                }
              }
            }
          }
        },
        {
          "image": {
            "remove": {
              "image": "alpine",
              "tag": "${version[alpine]}"
            }
          }
        }
      ]
    }
  ]
}
